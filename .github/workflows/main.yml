name: CI

on: [push]

jobs:
  build:

    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v1
    - name: Update submodules
      run: git submodule update --init --recursive
    - name: Download the third party directory
      run: curl https://mega.nz/#!kAsQia7A!6-E0wO2N8BwSGfucwQRQ0mEWU1Yz-s-OjbaG3Vixb0M --output 3rdparty.zip
    - name: Unzip the third party library
      run: unzip 3rdparty.zip -d ./.github/iMEGA/Vendor/sdk/bindings/ios/3rdparty/
    - name: Move to karere directory
      run: cd ./.github/iMEGA/Vendor/Karere/src/
    - name: Run the cmake command on karere directory
      run: cmake -P genDbSchema.cmake
    - name: Return back to main directory
      run: cd ./.github/
    - name: Build the project
      run: xcodebuild clean build -workspace ./.github/iMEGA.xcworkspace -scheme "MEGA"



 
